GHA FTW

–Ø —Å—Ç–∞—Ä–∞—é—Å—å –Ω–µ —Ä–∞–∑–≤–æ–¥–∏—Ç—å —É —Å–µ–±—è –Ω–∞ –¥–æ–º–∞—à–Ω–µ–π –º–∞—à–∏–Ω–µ –ª–∏—à–Ω–∏—Ö –æ–∫—Ä—É–∂–µ–Ω–∏–π. –í–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –º–∞—à–∏–Ω–∞¬†‚Äî –∫–∞–∫ –ø—Ä–æ—Å—Ç–∏—Ç—É—Ç–∫–∞: –ª–µ–≥–∫–æ–¥–æ—Å—Ç—É–ø–Ω–∞, –Ω–æ –¥–ª—è –Ω–∞—Å—Ç–æ—è—â–µ–≥–æ —Å–µ–∫—Å–∞ –º–∞–ª–æ–ø—Ä–∏–≥–æ–¥–Ω–∞. –î–æ–∫–µ—Ä –±—ã–ª –ø—Ä–∏–¥—É–º–∞–Ω, —á—Ç–æ–±—ã –æ–ø—Ä–∞–≤–¥–∞—Ç—å –±–µ—Å—Å–º—ã—Å–ª–µ–Ω–Ω—É—é –ø—Ä–æ—Ñ–µ—Å—Å–∏—é ¬´–¥–µ–≤–æ–ø—Å¬ª, —Å–¥–µ–ª–∞—Ç—å –ë–µ–∑–æ—Å–∞ –µ—â–µ –±–æ–≥–∞—á–µ –∏ —Å–¥–µ–ª–∞—Ç—å –≤–æ–∑–º–æ–∂–Ω—ã–º –∏ –±–µ–∑ —Ç–æ–≥–æ –¥–æ–≤–æ–ª—å–Ω–æ —Ç—Ä–∏–≤–∏–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏¬†‚Äî –¥–æ—Å—Ç—É–ø–Ω—ã–º —Å–æ–≤—Å–µ–º —É–∂ –¥—É—Ä–∞—á–∫–∞–º.

–° –¥—Ä—É–≥–æ–π —Å—Ç–æ—Ä–æ–Ω—ã, –æ–±–ª–∞–∫–∞¬†‚Äî –Ω–∏–∫—É–¥–∞ –Ω–µ –≥–æ–¥—è—Ç—Å—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö, –Ω–æ –¥–ª—è –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã—Ö –º–æ—â–Ω–æ—Å—Ç–µ–π¬†‚Äî –ø–æ–¥—Ö–æ–¥—è—Ç –∏–¥–µ–∞–ª—å–Ω–æ. –¢–∞–∫ –ø–æ—á–µ–º—É –±—ã –Ω–µ –ø–µ—Ä–µ–ø–æ—Ä—É—á–∏—Ç—å —Å—Ç–æ—Ä–æ–Ω–Ω–∏–º —Å–µ—Ä–≤–∏—Å–∞–º –≤—Å—é —Ä—É—Ç–∏–Ω—É?

–í–æ—Ç, –Ω–∞–ø—Ä–∏–º–µ—Ä, —ç—Ç–æ—Ç –±–ª–æ–≥. –Ø –Ω–µ —Ç–µ—Ä–ø–ª—é ¬´–¥–≤–∏–∂–∫–∏¬ª, –ø–æ—Ç–æ–º—É —á—Ç–æ –Ω–µ—Ç –Ω–∏–∫–∞–∫–∏—Ö –ø—Ä–∏—á–∏–Ω –≥–æ–Ω—è—Ç—å –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä (–ø—É—Å—Ç—å –∏ –Ω–µ –º–æ–π, –∞ –æ–±–ª–∞—á–Ω—ã–π)¬†‚Äî –∫–∞–∂–¥—ã–π —Ä–∞–∑, –∫–æ–≥–¥–∞ –∫—Ç–æ-—Ç–æ –∑–∞—Ö–æ—Ç–µ–ª –ø—Ä–∏–æ–±—â–∏—Ç—å—Å—è –∫ –≤–µ–ª–∏–∫–æ–º—É. –ö–∞—Ä–±–æ–Ω–æ–≤—ã–π —Å–ª–µ–¥, –≥–ª–æ–±–∞–ª—å–Ω–æ–µ –ø–æ—Ç–µ–ø–ª–µ–Ω–∏–µ, –ì—Ä–µ—Ç–∞ –¢—É–Ω–±–µ—Ä–≥,¬†‚Äî –æ–Ω–∏ –º–Ω–µ –≤—Å–µ, —Ä–∞–∑—É–º–µ–µ—Ç—Å—è, –¥–æ —Ñ–µ–Ω–∏, –Ω–æ –¥–ª—è —Å–∞–π—Ç–∞ —Å —Ç–µ–∫—Å—Ç–∞–º–∏¬†‚Äî –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –æ–¥–∏–Ω: `html`. –®–∞–±–ª–æ–Ω–∞–º–∏ –Ω–∞ –ø–æ—Ö–∞–ø–µ –ø—É—Å–∫–∞–π –Ω–µ–¥–æ–¥–µ–ª–∞–Ω–Ω—ã–µ –±—ç–∫–µ–Ω–¥–µ—Ä—ã –≤–æ—Ä–æ—á–∞—é—Ç. –î–∞, —è –∑–Ω–∞—é –ø—Ä–æ –∫–µ—à, –Ω–µ—Ç, —ç—Ç–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ.

–° –¥—Ä—É–≥–æ–π —Å—Ç–æ—Ä–æ–Ω—ã, —Ö–æ—á–µ—Ç—Å—è –ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å—Å—è –≤ –æ–¥–Ω–æ –¥–µ–π—Å—Ç–≤–∏–µ, –∞ –Ω–µ –æ—Ç–≤–ª–µ–∫–∞—Ç—å—Å—è –Ω–∞ —Ä—É—Ç–∏–Ω—É. –≠—Ç–æ –æ–¥–Ω–æ –¥–µ–π—Å—Ç–≤–∏–µ –¥–æ–ª–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ñ–∞–π–ª –∏ –æ–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –≤—Å–µ –ø–æ–≤—Å—é–¥—É. –ù—É, —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ñ–∞–π–ª¬†‚Äî —ç—Ç–æ –≥–∏—Ç—Ö–∞–±. –ó–Ω–∞—á–∏—Ç, –æ–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å¬†‚Äî —ç—Ç–æ Github Actions. –ù—É –∏ –≤ –º–∞—Å—Ç–æ–¥–æ–Ω —Ç–∏—Å–Ω—É—Ç—å –∞–Ω–æ–Ω—Å –±—É–¥–µ—Ç –Ω–µ –ª–∏—à–Ω–µ–µ.

```yaml
name: üöÄ Build and Deploy on Push

on: [push]

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    env:
      MIX_ENV: dev
    name: üí° AmbMent Publishing
    strategy:
      fail-fast: true
      matrix:
        include:
          - pair:
              otp: 26.2
              elixir: 1.16
    steps:
      - name: üöö Get latest code
        uses: actions/checkout@v4
      
      - name: üíß Install OTP ${{matrix.pair.otp}} / Elixir ${{matrix.pair.elixir}}
        uses: erlef/setup-elixir@v1
        with:
          otp-version: ${{matrix.pair.otp}}
          elixir-version: ${{matrix.pair.elixir}}

      - name: üìú Install Node
        uses: actions/setup-node@v4
        with:
          node-version: 18

      - name: üíß Build static site
        run: |
          mix do deps.get, deps.compile, compile
          mix serum.build

      - name: üîé Build Pagefind Index
        run: |
          npx -y pagefind --site "site"

      - name: üìÇ Sync files
        uses: SamKirkland/FTP-Deploy-Action@v4.3.4
        with:
          server: ${{ secrets.AMBMENT_DOMAIN }}
          username: ${{ secrets.AMBMENT_USER }}
          password: ${{ secrets.AMBMENT_PASS }}
          local-dir: "./site/"
          server-dir: "./datos/web/"
          dry-run: false

      - name: üêò Cross-post to Mastodon
        if: "contains(github.event.head_commit.message, ':elephant:')"
        env:
          AUTH_TOKEN: ${{ secrets.MASTODON_ACCESS_TOKEN }}
          MESSAGE: ${{ github.event.head_commit.message }}
        run: |
          npm i mastodon
          npm i glob
          node toot_it.js
```

–ï—â–µ —è —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–º –æ–±—Ä–∞–∑–æ–º –æ–±–ª–µ–≥—á–∏–ª —Å–µ–±–µ –∂–∏–∑–Ω—å –ø—Ä–∏ –Ω–∞–±–æ—Ä–µ —Ç–µ–∫—Å—Ç–∞: –º–æ–π –ø–∞—Ä—Å–µ—Ä –º–∞—Ä–∫–¥–∞—É–Ω–∞ –Ω–∞—Å—Ç–æ–ª—å–∫–æ —Ä–∞—Å—à–∏—Ä—è–µ–º—ã–π –ø–æ–¥ –º–æ–∏ –Ω—É–∂–¥—ã, —á—Ç–æ —è –º–æ–≥—É –ª—é–±—ã–µ —Ç–µ–≥–∏ —Å –ª—é–±—ã–º–∏ –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏¬†‚Äî –±—É–∫–≤–∞–ª—å–Ω–æ –ø–æ–≤–µ—Å–∏—Ç—å –Ω–∞ ¬´–≥–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏¬ª. –ù–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –≤–µ—Ä—Ö–Ω–µ–≥–æ –∏–Ω–¥–µ–∫—Å–∞ —è –∏—Å–ø–æ–ª—å–∑—É—é `N^2^`, –∞ –¥–ª—è –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏—è –ø–æ —Ü–µ–Ω—Ç—Ä—É¬†‚Äî `‚áí –ø–æ —Ü–µ–Ω—Ç—Ä—É ‚áê`. –ù–æ –æ–± —ç—Ç–æ–º –∫–∞–∫-–Ω–∏–±—É–¥—å –≤ –¥—Ä—É–≥–æ–π —Ä–∞–∑.

–í —Å—Ä–µ–¥–Ω–µ–º, —è –ø—Ä–æ—Å—Ç–æ –ø–∏—à—É —Ç–µ–∫—Å—Ç, –∏ –¥–æ–±–∞–≤–ª—è—é —Ñ–∞–π–ª —Å —Ç–µ–∫—Å—Ç–æ–º –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π. –ê –¥–∞–ª—å—à–µ –æ–Ω–æ —Ç–∞–º —Å–∞–º–æ: –∏–Ω–¥–µ–∫—Å –ø–æ–∏—Å–∫–∞ –ø–µ—Ä–µ—Å—Ç—Ä–æ–∏—Ç, –≤—ã–ª–æ–∂–∏—Ç –≤—Å–µ –Ω–∞ `ftp`, –æ–ø–æ–≤–µ—Å—Ç–∏—Ç —á–∏—Ç–∞—Ç–µ–ª–µ–π —á–µ—Ä–µ–∑ –º–∞—Å—Ç–æ–¥–æ–Ω.